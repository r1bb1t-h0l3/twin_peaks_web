{% extends 'base.html' %}

{% block content %}
    <div class="two-column-container-item">
        <img src="{{ url_for('static', filename='images/reservation_1.jpg') }}" alt="couple sitting at diner table">
        <div class="reservation-text">
            <h2>How to make a reservation</h2>
            <p>
                You can make a reservation by calling us at <em>425-831-5512</em> or using our handy-dandy reservation form below.    
            </p>
            <p>No deposit is necessary, but please let us know at least 2 hours in advance if you wish to cancel.</p>
            <p>For reservations of <strong>more than 6 people</strong> please contact us directly via our phone number. </p>
        </div>

        <!-- Flash message
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        {% endwith %} -->
        <!-- Calendar -->

        <div id="calendar"></div>
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    var calendarEl = document.getElementById('calendar');
                    var calendar = new FullCalendar.Calendar(calendarEl, {
                        initialView: 'dayGridMonth',
                        events: [],
                        dateClick: function (info) {
                            fetch(`/get_available_slots/${info.dateStr}`)
                                .then(response => response.json())
                                .then(data => {
                                // Show available slots in a modal or side panel
                                    console.log(data); // Replace this with your rendering logic
                                });
                        },
                    });
                    calendar.render();
                });
            </script>


        <!-- Reservation Form -->
        <form id="reservationForm" method="POST">
            {{ form.hidden_tag() }}
            <div class="form-group">
                {{ form.name.label }}
                {{ form.name(class="form-control") }}
                <small id="nameError" class="text-danger"></small>
            </div>
            <div class="form-group">
                {{ form.email.label }}
                {{ form.email(class="form-control") }}
                <small id="emailError" class="text-danger"></small>
            </div>
            <div class="form-group">
                {{ form.num_people.label }}
                {{ form.num_people(class="form-control") }}
                <small id="numPeopleError" class="text-danger"></small>
            </div>
            <div class="form-group">
                {{ form.date.label }}
                {{ form.date(class="form-control") }}
                <small id="dateError" class="text-danger"></small>
            </div>
            <div>
                <label for="timeSlot">Time Slot:</label>
                <select id="timeSlot" name="time">
                    <!-- POpulate slots dynamically -->
                </select>          
            </div>
            <button type="submit" class="btn btn-primary">Reserve Table</button>
        </form>
        <div id="confirmationMessage" style="margin-top: 20px;"></div>
    </div>
{% endblock %}
